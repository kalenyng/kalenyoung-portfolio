---
import HeroScene from './3d/HeroScene';
---

<section class="relative min-h-screen overflow-hidden">
  <!-- Gradient background with 3D scene -->
  <div
    class="absolute inset-0 bg-gradient-to-b"
    style="background: linear-gradient(to bottom, var(--hero-sky-start), var(--hero-sky-end));"
    id="hero-bg"
  >
    <!-- 3D Scene Layer -->
    <HeroScene client:idle />
  </div>
  
  <div class="absolute inset-0" id="hero-bg-overlay">
    <!-- Mountain layer 1 (back) - Most parallax -->
    <!-- Extended below viewport to prevent edge exposure on scroll -->
    <svg
      class="absolute w-full pointer-events-none"
      viewBox="0 0 1440 320"
      preserveAspectRatio="none"
      style="height: 100%; bottom: -20%;"
      id="mountain-back"
    >
      <path
        fill="var(--hero-mountain)"
        fill-opacity="0.3"
        d="M0,96L48,112C96,128,192,160,288,165.3C384,171,480,149,576,128C672,107,768,85,864,90.7C960,96,1056,128,1152,138.7C1248,149,1344,139,1392,133.3L1440,128L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"
      ></path>
    </svg>
    
    <!-- Mountain layer 2 (middle) - Some parallax -->
    <!-- Extended below viewport to prevent edge exposure on scroll -->
    <svg
      class="absolute w-full pointer-events-none"
      viewBox="0 0 1440 320"
      preserveAspectRatio="none"
      style="height: 90%; bottom: -10%;"
      id="mountain-mid"
    >
      <path
        fill="var(--hero-mountain)"
        fill-opacity="0.5"
        d="M0,192L48,197.3C96,203,192,213,288,208C384,203,480,181,576,170.7C672,160,768,160,864,165.3C960,171,1056,181,1152,181.3C1248,181,1344,171,1392,165.3L1440,160L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"
      ></path>
    </svg>
    
    <!-- Mountain layer 3 (front) - Fixed at bottom, no parallax -->
    <svg
      class="absolute bottom-0 w-full pointer-events-none"
      viewBox="0 0 1440 320"
      preserveAspectRatio="none"
      style="height: 60%;"
      id="mountain-front"
    >
      <path
        fill="var(--hero-mountain)"
        fill-opacity="0.8"
        d="M0,256L48,245.3C96,235,192,213,288,213.3C384,213,480,235,576,234.7C672,235,768,213,864,202.7C960,192,1056,192,1152,197.3C1248,203,1344,213,1392,218.7L1440,224L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"
      ></path>
    </svg>
  </div>

  <!-- Content -->
  <div class="relative z-10 flex min-h-screen items-center">
    <div class="section w-full">
      <div class="mx-auto max-w-4xl space-y-8 text-center">
        <!-- Greeting badge -->
        <div class="hero-element" data-delay="0">
          <span
            class="inline-block rounded-full px-4 py-2 text-sm font-medium"
            style="background-color: var(--bg-elevated); color: var(--text-secondary);"
          >
            ðŸ‘‹ Hello, I'm Kalen
          </span>
        </div>

        <!-- Main heading -->
        <h1
          class="hero-element font-heading text-6xl font-bold leading-tight tracking-tight md:text-8xl"
          style="color: var(--text-primary);"
          data-delay="0.15"
        >
          I build user-focused <span class="gradient-text">digital experiences</span> that connect creativity with code
        </h1>

        <!-- Subheading -->
        <p
          class="hero-element prose-text mx-auto text-xl leading-relaxed md:text-2xl"
          style="color: var(--text-secondary);"
          data-delay="0.3"
        >
          Modern web applications designed with accessibility, performance, and attention to detail.
        </p>

        <!-- CTA -->
        <div class="hero-element flex justify-center gap-4" data-delay="0.45">
          <a href="#projects" class="btn-primary" data-magnetic>
            View my work
            <svg
              class="h-5 w-5"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
              stroke-width="2"
            >
              <path stroke-linecap="round" stroke-linejoin="round" d="M19 14l-7 7m0 0l-7-7m7 7V3"
              ></path>
            </svg>
          </a>
          <a href="#contact" class="btn-secondary">
            Get in touch
          </a>
        </div>

        <!-- Scroll indicator -->
        <div class="pt-12">
          <div class="inline-block animate-bounce">
            <svg
              class="h-6 w-6 opacity-50"
              style="color: var(--text-muted);"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M19 14l-7 7m0 0l-7-7m7 7V3"></path>
            </svg>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  import { animate } from 'motion';
  import { parallax } from '@/utils/animations';

  // Parallax mountains - separate layers with different speeds
  const mountainBack = document.getElementById('mountain-back');
  const mountainMid = document.getElementById('mountain-mid');
  // mountain-front stays fixed (no parallax) to prevent gaps
  
  if (mountainBack) {
    parallax(mountainBack, -0.18); // More parallax (furthest away)
  }
  
  if (mountainMid) {
    parallax(mountainMid, -0.09); // Medium parallax
  }

  // Stagger hero elements
  const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
  
  if (!prefersReducedMotion) {
    const heroElements = document.querySelectorAll('.hero-element');
    heroElements.forEach((element) => {
      const delay = parseFloat(element.getAttribute('data-delay') || '0');
      
      animate(
        element,
        { opacity: [0, 1], transform: ['translateY(20px)', 'translateY(0)'] },
        { 
          delay, 
          duration: 0.6, 
          easing: [0.22, 1, 0.36, 1]
        }
      );
    });
  }
</script>

<style>
  .hero-element {
    opacity: 0;
  }
</style>

